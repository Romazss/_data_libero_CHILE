<!-- /web_app/frontend/index.html - Fase 2 -->
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Biblioteca de Datos Abiertos de Chile â€” Portal de Monitoreo</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ‡¨ðŸ‡±</text></svg>">
</head>
<body>
  <!-- Header mejorado -->
  <header class="container">
    <div class="header-content">
      <div class="title-section">
        <h1>ðŸ‡¨ðŸ‡± Biblioteca de Datos Abiertos</h1>
        <p class="subtitle">Monitoreo en tiempo real de datasets pÃºblicos de Chile</p>
      </div>
      
      <!-- Notificaciones -->
      <div class="notifications-section">
        <button class="notification-btn" id="notificationBtn">
          <span class="notification-icon">ðŸ””</span>
          <span class="notification-badge" id="notificationBadge">0</span>
        </button>
        <div class="connection-status" id="connectionStatus">
          <span class="status-indicator offline" id="statusIndicator"></span>
          <span class="status-text" id="statusText">Desconectado</span>
        </div>
      </div>
      
      <div class="stats-summary" id="statsSummary">
        <div class="stat-card">
          <span class="stat-number" id="totalDatasets">-</span>
          <span class="stat-label">Datasets</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="availableDatasets">-</span>
          <span class="stat-label">Disponibles</span>
        </div>
        <div class="stat-card">
          <span class="stat-number" id="avgLatency">-</span>
          <span class="stat-label">Latencia promedio</span>
        </div>
      </div>
    </div>
    
    <!-- Toolbar expandida -->
    <div class="toolbar">
      <div class="toolbar-section">
        <button id="refreshBtn" class="btn btn-primary">
          <span class="btn-icon">ðŸ”„</span>
          Actualizar
        </button>
        
        <button id="forceCheckBtn" class="btn btn-secondary">
          <span class="btn-icon">âš¡</span>
          Verificar Ahora
        </button>
      </div>
      
      <div class="toolbar-section">
        <label class="input-group">
          <span>CategorÃ­a:</span>
          <select id="categoryFilter">
            <option value="">Todas</option>
          </select>
        </label>
        
        <label class="input-group">
          <span>Estado:</span>
          <select id="statusFilter">
            <option value="">Todos</option>
            <option value="up">Disponibles</option>
            <option value="down">No disponibles</option>
          </select>
        </label>
      </div>
      
      <div class="toolbar-section">
        <label class="input-group">
          <span>Auto-refresco:</span>
          <select id="autoRefresh">
            <option value="0">Off</option>
            <option value="30">30s</option>
            <option value="60" selected>60s</option>
            <option value="300">5min</option>
          </select>
        </label>
      </div>
    </div>
  </header>

  <!-- Main content -->
  <main class="container">
    <!-- Indicador de carga -->
    <div id="loadingIndicator" class="loading-indicator hidden">
      <div class="spinner"></div>
      <span>Cargando datos...</span>
    </div>
    
    <!-- Tabla de datasets -->
    <div class="table-container">
      <table id="table" class="table">
        <thead>
          <tr>
            <th>Dataset</th>
            <th>CategorÃ­a</th>
            <th>Estado</th>
            <th>Latencia</th>
            <th>HTTP</th>
            <th>Ãšltima verificaciÃ³n</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
    
    <!-- Mensaje de error -->
    <div id="error" class="error hidden"></div>
    
    <!-- Mensaje cuando no hay datos -->
    <div id="noData" class="no-data hidden">
      <div class="no-data-content">
        <span class="no-data-icon">ðŸ“Š</span>
        <h3>No hay datos disponibles</h3>
        <p>No se encontraron datasets que coincidan con los filtros aplicados.</p>
        <button id="clearFiltersBtn" class="btn btn-primary">Limpiar filtros</button>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="container footer">
    <div class="footer-content">
      <div class="footer-section">
        <small>
          Fase 2 Â· API Robusta Â· 
          <a href="https://github.com/Romazss/_data_libero_CHILE" target="_blank" rel="noreferrer">
            Repositorio GitHub
          </a>
        </small>
      </div>
      
      <div class="footer-section">
        <div class="api-status" id="apiStatus">
          <span class="status-indicator" id="statusIndicator"></span>
          <span id="statusText">Conectando...</span>
        </div>
      </div>
      
      <div class="footer-section">
        <span id="lastUpdated" class="last-updated">-</span>
      </div>
    </div>
  </footer>

  <!-- Modal para histÃ³rico de dataset -->
    <!-- Modal de Notificaciones -->
  <div id="notificationsModal" class="modal hidden">
    <div class="modal-content notifications-modal">
      <div class="modal-header">
        <h3>ðŸ”” Notificaciones</h3>
        <div class="modal-header-actions">
          <button id="clearNotificationsBtn" class="btn btn-secondary">Limpiar todo</button>
          <button id="closeNotificationsModal" class="close-btn">Ã—</button>
        </div>
      </div>
      <div class="modal-body">
        <div id="notificationsContent" class="notifications-content">
          <div class="loading-indicator">
            <div class="spinner"></div>
            <span>Cargando notificaciones...</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de HistÃ³rico (existing) -->
  <div id="historyModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="historyModalTitle">HistÃ³rico del Dataset</h3>
        <button id="closeHistoryModal" class="close-btn">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="history-controls">
          <label>
            PerÃ­odo:
            <select id="historyPeriod">
              <option value="1">Ãšltima hora</option>
              <option value="6">Ãšltimas 6 horas</option>
              <option value="24" selected>Ãšltimo dÃ­a</option>
              <option value="168">Ãšltima semana</option>
            </select>
          </label>
        </div>
        <div id="historyContent" class="history-content">
          <div class="loading-indicator">
            <div class="spinner"></div>
            <span>Cargando histÃ³rico...</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay para modal -->
  <div id="modalOverlay" class="modal-overlay hidden"></div>

  <!-- Socket.IO Client -->
  <script src="/socket.io/socket.io.js"></script>
  <script src="app.js"></script>
</body>
</html>

  <!-- Overlay para modal -->
  <div id="modalOverlay" class="modal-overlay hidden"></div>

  <script src="app.js"></script>
</body>
</html>
</html>